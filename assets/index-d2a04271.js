import{g as e,_ as t,k as o}from"./plugin-vue_export-helper-806773bb.js";import{f as n,I as l,w as a,c as i}from"./index-952d7730.js";import{I as p}from"./index-b9112127.js";import{d as s,a4 as r,K as u,q as d,o as c,a as y,l as v,n as f,c as m,j as x,k as h,e as b,m as g,a8 as C,f as T,a9 as w,s as E,av as j,Q as k,t as B,r as P,L as O,w as $,T as S,al as I}from"./runtime-core.esm-bundler-808dc7a8.js";import{T as R}from"./index-b22601c3.js";import{I as N,a as A}from"./index-277ef83a.js";import{u as H}from"./index-69460413.js";import{R as z}from"./resize-observer-aef80884.js";import{o as _}from"./use-popup-manager-c09cb0b2.js";import{u as q}from"./use-merge-state-ed08ed92.js";import{c as D,r as K}from"./index-39ecde43.js";import{P as M}from"./index-15ee7962.js";var F=t(s({name:"TypographyEditContent",components:{Input:p},props:{text:{type:String,required:!0}},emits:["change","end","update:text"],setup(t,{emit:o}){const n=[`${e("typography")}-edit-content`],l=r();function a(){o("end")}return u((()=>{if(!l.value||!l.value.$el)return;const e=l.value.$el.querySelector("input");if(!e)return;e.focus&&e.focus();const{length:t}=e.value;e.setSelectionRange(t,t)})),{classNames:n,inputRef:l,onBlur:a,onChange:function(e){o("update:text",e),o("change",e)},onEnd:a}}}),[["render",function(e,t,o,l,a,i){const p=d("Input");return c(),y("div",{class:f(e.classNames)},[v(p,{ref:"inputRef","auto-size":"","model-value":e.text,onBlur:e.onBlur,onInput:e.onChange,onKeydown:n(e.onEnd,["enter"])},null,8,["model-value","onBlur","onInput","onKeydown"])],2)}]]);var L=t(s({name:"TypographyOperations",components:{Tooltip:R,IconCheckCircleFill:l,IconCopy:N,IconEdit:A},props:{editable:Boolean,copyable:Boolean,expandable:Boolean,isCopied:Boolean,isEllipsis:Boolean,expanded:Boolean,forceRenderExpand:Boolean,editTooltipProps:Object,copyTooltipProps:Object},emits:{edit:()=>!0,copy:()=>!0,expand:()=>!0},setup(t,{emit:o}){const n=e("typography"),l=m((()=>t.forceRenderExpand||t.expandable&&t.isEllipsis)),{t:a}=H();return{prefixCls:n,showExpand:l,t:a,onEditClick(){o("edit")},onCopyClick(){o("copy")},onExpandClick(){o("expand")}}}}),[["render",function(e,t,o,n,l,i){const p=d("IconEdit"),s=d("Tooltip"),r=d("IconCheckCircleFill"),u=d("IconCopy");return c(),y(k,null,[e.editable?(c(),x(s,g({key:0,content:e.t("typography.edit")},e.editTooltipProps),{default:h((()=>[b("span",{class:f(`${e.prefixCls}-operation-edit`),onClick:t[0]||(t[0]=a(((...t)=>e.onEditClick&&e.onEditClick(...t)),["stop"]))},[v(p)],2)])),_:1},16,["content"])):C("v-if",!0),e.copyable?(c(),x(s,j(g({key:1},e.copyTooltipProps)),{content:h((()=>[T(e.$slots,"copy-tooltip",{copied:e.isCopied},(()=>[w(E(e.isCopied?e.t("typography.copied"):e.t("typography.copy")),1)]))])),default:h((()=>[b("span",{class:f({[`${e.prefixCls}-operation-copied`]:e.isCopied,[`${e.prefixCls}-operation-copy`]:!e.isCopied}),onClick:t[1]||(t[1]=a(((...t)=>e.onCopyClick&&e.onCopyClick(...t)),["stop"]))},[T(e.$slots,"copy-icon",{copied:e.isCopied},(()=>[e.isCopied?(c(),x(r,{key:0})):(c(),x(u,{key:1}))]))],2)])),_:3},16)):C("v-if",!0),e.showExpand?(c(),y("a",{key:2,class:f(`${e.prefixCls}-operation-expand`),onClick:t[2]||(t[2]=a(((...t)=>e.onExpandClick&&e.onExpandClick(...t)),["stop"]))},[T(e.$slots,"expand-node",{expanded:e.expanded},(()=>[w(E(e.expanded?e.t("typography.collapse"):e.t("typography.expand")),1)]))],2)):C("v-if",!0)],64)}]]);let Q;function V(e){if(!e)return 0;const t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0}var Y=(e,t,o,n)=>{Q||(Q=document.createElement("div"),document.body.appendChild(Q));const{rows:l,suffix:a,ellipsisStr:p}=t,s=window.getComputedStyle(e),r=(u=s,Array.prototype.slice.apply(u).map((e=>`${e}: ${u.getPropertyValue(e)};`)).join(""));var u;const d=V(s.lineHeight),c=Math.round(d*l+V(s.paddingTop)+V(s.paddingBottom));Q.setAttribute("style",r),Q.setAttribute("aria-hidden","true"),Q.style.height="auto",Q.style.minHeight="auto",Q.style.maxHeight="auto",Q.style.position="fixed",Q.style.left="0",Q.style.top="-99999999px",Q.style.zIndex="-200",Q.style.whiteSpace="normal";const y=i({render:()=>v("span",null,[o])});y.mount(Q);const f=Array.prototype.slice.apply(Q.childNodes[0].cloneNode(!0).childNodes);y.unmount(),Q.innerHTML="";const m=document.createTextNode(`${p}${a}`);Q.appendChild(m),f.forEach((e=>{Q.appendChild(e)}));const x=document.createTextNode(n);function h(){return Q.offsetHeight<=c}if(Q.insertBefore(x,m),h())return{ellipsis:!1,text:n};return function e(t,o=0,l=n.length,a=0){const i=Math.floor((o+l)/2),p=n.slice(0,i);if(t.textContent=p,o>=l-1)for(let s=l;s>=o;s-=1){const e=n.slice(0,s);if(t.textContent=e,h()||!e)return}h()?e(t,i,l,i):e(t,o,i,a)}(x),{text:x.textContent,ellipsis:!0}};const Z=e=>{return t=void 0,o=null,n=function*(){var t;if(null==(t=navigator.clipboard)?void 0:t.writeText)try{return void(yield navigator.clipboard.writeText(e))}catch(a){}const o=document.createElement("span");o.textContent=e,o.style.whiteSpace="pre",document.body.appendChild(o);const n=window.getSelection(),l=window.document.createRange();null==n||n.removeAllRanges(),l.selectNode(o),null==n||n.addRange(l);try{window.document.execCommand("copy")}catch(a){}null==n||n.removeAllRanges(),window.document.body.removeChild(o)},new Promise(((e,l)=>{var a=e=>{try{p(n.next(e))}catch(t){l(t)}},i=e=>{try{p(n.throw(e))}catch(t){l(t)}},p=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,i);p((n=n.apply(t,o)).next())}));var t,o,n};let G;var J=Object.defineProperty,U=Object.defineProperties,W=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertySymbols,ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable,oe=(e,t,o)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,ne=(e,t)=>{for(var o in t||(t={}))ee.call(t,o)&&oe(e,o,t[o]);if(X)for(var o of X(t))te.call(t,o)&&oe(e,o,t[o]);return e},le=(e,t)=>U(e,W(t));function ae(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!I(e)}function ie(e,t){const{mark:n}=e,l=function(e){const{bold:t,mark:o,underline:n,delete:l,code:a}=e,i=[];return t&&i.push("b"),n&&i.push("u"),l&&i.push("del"),a&&i.push("code"),o&&i.push("mark"),i}(e),a=o(n)&&n.color?{backgroundColor:n.color}:{};return l.reduce(((e,t)=>v(t,"mark"===t?{style:a}:{},ae(e)?e:{default:()=>[e]})),t)}var pe=s({name:"TypographyBase",inheritAttrs:!1,props:{component:{type:String,required:!0},type:{type:String},bold:{type:Boolean},mark:{type:[Boolean,Object],default:!1},underline:{type:Boolean},delete:{type:Boolean},code:{type:Boolean},disabled:{type:Boolean},editable:{type:Boolean},editing:{type:Boolean,default:void 0},defaultEditing:{type:Boolean},editText:{type:String},copyable:{type:Boolean},copyText:{type:String},copyDelay:{type:Number,default:3e3},ellipsis:{type:[Boolean,Object],default:!1},editTooltipProps:{type:Object},copyTooltipProps:{type:Object}},emits:{editStart:()=>!0,change:e=>!0,"update:editText":e=>!0,editEnd:()=>!0,"update:editing":e=>!0,copy:e=>!0,ellipsis:e=>!0,expand:e=>!0},setup(t,{slots:n,emit:l,attrs:a}){const{editing:p,defaultEditing:s,ellipsis:d,copyable:c,editable:y,copyText:f,editText:x,copyDelay:h,component:b}=B(t),C=e("typography"),T=m((()=>[C,{[`${C}-${t.type}`]:t.type,[`${C}-disabled`]:t.disabled}])),w=r(),E=r(""),[j,k]=q(s.value,P({value:p})),I=m((()=>y.value&&j.value));function N(){l("update:editing",!0),l("editStart"),k(!0)}function A(){j.value&&(l("update:editing",!1),l("editEnd"),k(!1))}const H=r(!1);let Q=null;function V(){var e;const t=null!=(e=f.value)?e:E.value;Z(t||""),H.value=!0,l("copy",t),Q=setTimeout((()=>{H.value=!1}),h.value)}O((()=>{Q&&clearTimeout(Q),Q=null}));const J=r(!1),U=r(!1),W=r(""),X=m((()=>function(e){const t=!!e.showTooltip,n=o(e.showTooltip)&&"popover"===e.showTooltip.type?M:R,l=o(e.showTooltip)&&e.showTooltip.props||{};return le(ne({rows:1,suffix:"",ellipsisStr:"...",expandable:!1,css:!1},_(e,["showTooltip"])),{showTooltip:t,TooltipComponent:n,tooltipProps:l})}(o(d.value)&&d.value||{})));let ee=null;function te(){const e=!U.value;U.value=e,l("expand",e)}function oe(e=!1){return X.value.css?v(L,{editable:y.value,copyable:c.value,expandable:X.value.expandable,isCopied:H.value,isEllipsis:de.value,expanded:U.value,forceRenderExpand:e||U.value,editTooltipProps:t.editTooltipProps,copyTooltipProps:t.copyTooltipProps,onEdit:N,onCopy:V,onExpand:te},{"copy-tooltip":n["copy-tooltip"],"copy-icon":n["copy-icon"],"expand-node":n["expand-node"]}):v(L,{editable:y.value,copyable:c.value,expandable:X.value.expandable,isCopied:H.value,isEllipsis:J.value,expanded:U.value,forceRenderExpand:e,editTooltipProps:t.editTooltipProps,copyTooltipProps:t.copyTooltipProps,onEdit:N,onCopy:V,onExpand:te},{"copy-tooltip":n["copy-tooltip"],"copy-icon":n["copy-icon"],"expand-node":n["expand-node"]})}function pe(){d.value&&!U.value&&(D(ee),ee=K((()=>{!function(){if(!w.value)return;const{ellipsis:e,text:t}=Y(w.value,X.value,oe(!!X.value.expandable),E.value);J.value!==e&&(J.value=e,X.value.css||l("ellipsis",e)),W.value!==t&&(W.value=t||"")}()})))}O((()=>{D(ee)})),$((()=>X.value.rows),(()=>{pe()})),$(d,(e=>{e?pe():J.value=!1}));let se=[];const re=()=>{if(d.value||c.value||y.value){const e=function(e){if(!e)return"";G||(G=document.createElement("div"),G.setAttribute("aria-hidden","true"),document.body.appendChild(G));const t=i({render:()=>v("div",null,[e])});t.mount(G);const o=G.innerText;return t.unmount(),o}(se);e!==E.value&&(E.value=e,pe())}};u(re),S(re);const ue=r(),de=r(!1),ce=()=>{if(w.value&&ue.value){const e=ue.value.offsetHeight>w.value.offsetHeight;e!==de.value&&(de.value=e,l("ellipsis",e))}},ye=m((()=>U.value?{}:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":X.value.rows,"-webkit-box-orient":"vertical"}));return()=>{var e,o;if(se=(null==(e=n.default)?void 0:e.call(n))||[],I.value){const e=null!=(o=x.value)?o:E.value;return v(F,{text:e,onChange:t=>{t!==e&&function(e){l("update:editText",e),l("change",e)}(t)},onEnd:A},null)}const{suffix:i,ellipsisStr:p,showTooltip:s,tooltipProps:r,TooltipComponent:u}=X.value,d=J.value&&!U.value,c=d&&!s?{title:E.value}:{},y=b.value;if(X.value.css){const e=ie(t,se),o=v(y,g({class:T.value,ref:w,style:ye.value},c,a),{default:()=>[v("span",{ref:ue},[e])]});return de.value?v(u,g(r,{onResize:()=>ce()}),{default:()=>[o],content:()=>E.value}):v(z,{onResize:()=>{ce()}},ae(o)?o:{default:()=>[o]})}const f=ie(t,d?W.value:se);return v(z,{onResize:()=>pe()},{default:()=>[v(y,g({class:T.value,ref:w},c,a),{default:()=>[d&&s?v(u,r,{default:()=>[v("span",null,[f])],content:()=>E.value}):f,d?p:null,i,oe()]})]})}}}),se=s({name:"TypographyText",inheritAttrs:!1,props:{ellipsis:{type:[Boolean,Object],default:!1}},setup(e){const{ellipsis:t}=B(e);return{component:m((()=>(null==t?void 0:t.value)?"div":"span"))}},render(){const{ellipsis:e,component:t}=this;return v(pe,g(this.$attrs,{ellipsis:e,component:t}),this.$slots)}});export{se as T};
